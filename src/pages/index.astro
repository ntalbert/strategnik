---
import BaseLayout from '../layouts/BaseLayout.astro';
import NewsletterForm from '../components/NewsletterForm.astro';
import BrandGravityHero from '../components/BrandGravityHero.astro';
import { getCollection } from 'astro:content';

// Fetch posts from content collection
const contentPosts = await getCollection('posts', ({ data }) => data.draft !== true);

const posts = contentPosts.map((post) => ({
  title: post.data.title,
  description: post.data.description,
  date: post.data.date,
  image: post.data.image,
  url: `/writing/${post.slug}`,
  type: 'Article',
}));

// Case studies with dates for sorting
const caseStudies = [
  {
    title: "Building 17 Nurture Paths",
    description: "How lifecycle segmentation cut lead-to-value time from 47 days to 19",
    image: "/case-studies/hero-image-03.png",
    url: '/case-studies/case-study-03-lifecycle-archetypes.html',
    date: new Date('2025-01-15'),
    type: 'Case Study',
  },
  {
    title: "Developer-to-Enterprise Pipeline",
    description: "Turning GitHub stars into six-figure deals for open source AI",
    image: "/case-studies/hero-image-01.png",
    url: '/case-studies/case-study-01-developer-discovery.html',
    date: new Date('2025-01-10'),
    type: 'Case Study',
  },
  {
    title: "Propensity Scoring That Works",
    description: "How data governance made predictive models 30% more accurate",
    image: "/case-studies/hero-image-02.png",
    url: '/case-studies/case-study-02-propensity-scoring.html',
    date: new Date('2025-01-05'),
    type: 'Case Study',
  },
];

// Combine and sort by date, take latest 3
const allContent = [...posts, ...caseStudies]
  .sort((a, b) => b.date.getTime() - a.date.getTime())
  .slice(0, 3);
---

<BaseLayout title="Home">
  <!-- Brand Gravity Hero Section -->
  <BrandGravityHero overlayOpacity={0.25}>
    <!-- Hero - First viewport -->
    <section class="min-h-screen flex items-center justify-center">
      <div class="container-narrow text-center py-20">
        <p class="text-caption text-blue-bright tracking-wide mb-6 font-bold">Strategnik</p>
        <h1 class="text-6xl md:text-7xl lg:text-8xl font-black mb-8 text-white leading-tight" data-animate-hero>
          Growth that builds gravity
        </h1>
        <p class="text-body-lg text-white font-bold max-w-prose mx-auto mb-10" data-animate-hero-sub>
          For B2B SaaS companies at inflection points—where the right GTM creates pull, not just push.
        </p>
        <div class="flex flex-wrap justify-center gap-6 font-bold" data-animate-hero-links>
          <a href="/services" class="text-white font-bold hover:text-blue-bright transition-colors">
            Start a conversation
          </a>
          <a href="/physics-of-marketing" class="text-white hover:text-blue-bright transition-colors">
            See how I work →
          </a>
        </div>
      </div>
    </section>

    <!-- Spacer -->
    <div class="h-[20vh]"></div>

    <!-- Quick Proof -->
    <section class="pb-16">
      <div class="container-narrow text-center">
        <p class="text-body-lg text-white font-bold mb-6">
          20+ years in B2B SaaS — 3 companies acquired — ~100% avg pipeline growth
        </p>
        <p class="text-body text-gray-400 max-w-prose mx-auto">
          Most recently VP of Marketing and Growth at BRIA AI, where I built signal-driven growth systems that drove 120% MAU lift.
        </p>
      </div>
    </section>

    <!-- Featured Content Carousel -->
    <section class="pb-32">
      <div class="container-content">
        <p class="text-caption text-blue-bright tracking-wide mb-6 font-bold text-center">Latest</p>
        <div class="flex gap-6 overflow-x-auto pb-4 snap-x snap-mandatory scrollbar-hide">
          {allContent.map((item) => (
            <a
              href={item.url}
              class="group flex-shrink-0 w-[320px] md:w-[380px] bg-gray-900 rounded-xl overflow-hidden border border-gray-800 hover:border-gray-700 hover:shadow-lg transition-all duration-300 snap-start"
            >
              <div class="aspect-video bg-gray-800 relative overflow-hidden">
                {item.image ? (
                  <img
                    src={item.image}
                    alt={item.title}
                    class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                  />
                ) : (
                  <div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900">
                    <div class="w-12 h-12 rounded-lg bg-gray-900 border border-gray-800 flex items-center justify-center">
                      <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
                      </svg>
                    </div>
                  </div>
                )}
                <div class="absolute top-3 left-3">
                  <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-900/90 text-white backdrop-blur-sm">
                    {item.type}
                  </span>
                </div>
              </div>
              <div class="p-5">
                <h3 class="font-semibold text-white group-hover:text-blue-bright transition-colors mb-2 line-clamp-2">{item.title}</h3>
                <p class="text-sm text-gray-400 line-clamp-2">{item.description}</p>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>

    <!-- Framework Section -->
    <section class="pb-16">
      <div class="container-narrow">
        <p class="text-caption text-white tracking-wide mb-6 font-bold">Framework</p>
        <h2 class="text-display-xl font-display italic text-white font-extrabold mb-8">
          The Physics of Marketing
        </h2>
        <p class="text-body-lg text-white font-bold max-w-prose">
          Marketing isn't art or science—it's engineering. I use a framework built on physics principles to diagnose what's actually happening in your marketing system.
        </p>
      </div>
    </section>

    <!-- Concepts -->
    <section class="pb-32">
      <div class="container-narrow">
        <div class="space-y-32">
          <div class="max-w-lg">
            <p class="text-white text-small mb-2 font-bold">01</p>
            <h3 class="text-display font-display italic text-white font-extrabold mb-4">Momentum</h3>
            <p class="text-body-lg text-white font-bold">
              Why some investments compound while others dissipate
            </p>
          </div>

          <div class="max-w-lg ml-auto text-right">
            <p class="text-white text-small mb-2 font-bold">02</p>
            <h3 class="text-display font-display italic text-white font-extrabold mb-4">Friction</h3>
            <p class="text-body-lg text-white font-bold">
              The hidden force destroying your conversion rates
            </p>
          </div>

          <div class="max-w-lg">
            <p class="text-white text-small mb-2 font-bold">03</p>
            <h3 class="text-display font-display italic text-white font-extrabold mb-4">Gravity</h3>
            <p class="text-body-lg text-white font-bold">
              Market forces pulling prospects toward (or away from) you
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="min-h-[50vh] flex items-center justify-center">
      <div class="text-center">
        <a href="/physics-of-marketing" class="text-heading font-display italic text-white font-extrabold hover:text-blue-bright transition-colors">
          Explore the framework →
        </a>
      </div>
    </section>
  </BrandGravityHero>

  <!-- Where's Your Growth Stuck Section -->
  <section class="section bg-black">
    <div class="container-narrow">
      <p class="text-body-lg text-white font-bold max-w-prose mb-8">
        Most marketing spend dissipates. Budget goes out, activity happens, nothing accumulates.
      </p>

      <p class="text-body-lg text-white font-bold max-w-prose mb-10">
        It's either a gravity problem or a friction problem.
      </p>

      <h2 class="text-display text-white font-bold mb-10" data-animate>Where's your growth stuck?</h2>

      <ul class="space-y-4 text-body-lg text-gray-400 mb-10 max-w-prose">
        <li>→ Not enough pull—we're chasing, not attracting</li>
        <li>→ Leaky funnel—leads come in, revenue doesn't</li>
        <li>→ Can't tell—we're flying blind</li>
      </ul>
    </div>
  </section>

  <!-- Selected Work Section -->
  <section class="section bg-black border-t border-gray-800">
    <div class="container-narrow">
      <p class="text-caption text-blue-bright tracking-wide mb-6 font-bold">Work</p>
      <h2 class="text-display text-white font-bold mb-10" data-animate>Selected Work</h2>

      <div class="space-y-8">
        <div class="border-b border-gray-800 pb-8">
          <h3 class="text-body-lg text-white font-bold mb-2">BRIA AI</h3>
        <p class="text-body text-gray-400">Built GTM ops from zero for visual AI platform serving EA, Disney, P&G</p>        </div>

        <div class="border-b border-gray-800 pb-8">
          <h3 class="text-body-lg text-white font-bold mb-2">Lumen Technologies</h3>
          <p class="text-body text-gray-400">26% improvement in data integrity, 30% lift in propensity scores</p>
        </div>

        <div class="border-b border-gray-800 pb-8">
          <h3 class="text-body-lg text-white font-bold mb-2">Wallarm</h3>
          <p class="text-body text-gray-400">20% increase in marketing-sourced pipeline, 18% conversion rate uplift</p>
        </div>
      </div>

      <div class="mt-10">
        <a href="/work" class="text-blue-bright hover:text-white transition-colors font-bold">
          See all work →
        </a>
      </div>
    </div>
  </section>

  <!-- Newsletter -->
  <NewsletterForm variant="default" />

  <!-- Footer CTA -->
  <section class="section bg-black border-t border-gray-800">
    <div class="container-narrow text-center">
      <h2 class="text-display text-white font-bold mb-6" data-animate>Ready to talk?</h2>
      <p class="text-body-lg text-gray-400 max-w-prose mx-auto mb-10">
        I do a 30-minute call with no pitch. You tell me what's happening, I tell you how I'd think about it. If there's a fit, we figure out next steps.
      </p>
      <a href="/services" class="text-blue-bright hover:text-white transition-colors font-bold text-body-lg">
        Start a conversation
      </a>
    </div>
  </section>
</BaseLayout>
